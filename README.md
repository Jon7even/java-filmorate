# Filmorate
> Сервис для выставления рейтинга фильмам. Мини кинопоиск в скромном репозитории. Даёт возможность пользователям
> выставлять оценки фильмам, заводить друзей и составлять рейтинг фильмов.
>

> [!IMPORTANT]
> Создано с помощью:
> - Java 11
> - Spring Boot
> - JDBC
> - H2
> - Lombok
> - Maven
> - MockMVC
> - Postman
>

> [!NOTE]
> Что это? Это backend веб сервиса сделанный по стилю RESTful API. Позволяет разобраться в проектировании монолита, 
> изучить Spring Boot, сборку проекта с помощью Maven. 
>
> - валидация данных на основе White List с использованием Stream.
> - кастомный валидатор для фильмов
> - реализация перехвата исключений обработчиком
> - тесты контроллеров на MockMVC
> - взаимодействие с БД через Java DataBase Connectivity (JDBC) 
> 

##ER Diagram:

![alt tag](/diagram.png)

Пример запроса: **get user name, birthday**:
```sql
SELECT 
       u.first_name AS user_name,
       u.birthday   AS user_birthday
  FROM user AS u
 LIMIT 10
;
```

Пример запроса: **get film id, name, duration, rating**:
```sql
SELECT 
       f.film_id,
       f.name     AS film_name,
       f.duration AS film_duration,
       r.name     AS film_rating
  FROM film AS f
  LEFT JOIN rating_mpa AS r
    ON f.rating_id = r.rating_id
;
```

Пример запроса: **get film name, count likes**:
```sql
SELECT 
       f.name            AS film_name,
       COUNT(fl.film_id) AS film_likes
  FROM film AS f
  LEFT JOIN film_likes AS fl
    ON f.film_id = fl.film_id
 GROUP 
    BY film_name
;
```


> Реализованные эндпоинты:
> - `User` (Пользователи) - создание, удаление, добавление друзей это всё здесь.
> - `Genre` (Жанры) - у каждого фильма должен быть жанр
> - `Film` (Фильмы) - взаимодействие пользователей с фильмами. Получить рейтинг фильмов и выставить оценки.
> - `RatingMPA` (Возрастной рейтинг) - получить доступные рейтинги.
>

> [!TIP]
> Что можно улучшить:
> - добавить возможность добавление `жанра`
> - перевести проект на микросервисную архитектуру, применив решение `Шлюз/Сервер`
> - добавить тесты на `JUnit`
> - добавить `DTO` классы и проекции
>

# Эндпоинты

## Пользователи
| Адрес                                      | Описание                                                        |
|--------------------------------------------|-----------------------------------------------------------------|
| `POST /users`                              | Создать нового `пользователя`                                   |
| `PUT /users`                               | Обновить данные о `пользователе`                                |
| `GET /users`                               | Получить список всех `пользователей`                            |
| `GET /users/{id}`                          | Получить данные о конкретном `пользователе` по ID               |
| `PUT /users/{id}/friends/{friendId}`       | Добавить `пользователя` в друзья по ID                          |
| `DELETE /users/{id}/friends/{friendId}`    | Удалить `пользователя` из друзей по ID                          |
| `GET /users/{id}/friends`                  | Получить список друзей `пользователя` по ID                     |
| `GET /users/{id}/friends/common/{otherId}` | Получить список общих друзей с конкретным `пользователем` по ID |


## Жанры
| Адрес                           | Описание                                |
|---------------------------------|-----------------------------------------|
| `GET /genres`                   | Получить список всех доступных `жанров` |
| `GET /genres/{id}`              | Получить конкретный `жанр` по ID        |


## Фильмы 
| Адрес                              | Описание                                                          |
|------------------------------------|-------------------------------------------------------------------|
| `POST /films`                      | Добавить новый `фильм`                                            |
| `PUT /films`                       | Обновить данные о `фильме`                                        |
| `GET /films`                       | Получить список всех `фильмов`                                    |
| `GET /films/popular?count={count}` | Получить список популярных `фильмов` с параметризованным запросом |
| `PUT /films/{id}/like/{userId}`    | Поставить лайк `фильму`                                           |
| `DELETE /films/{id}/like/{userId}` | Убрать лайк `фильму`                                              |


## Возрастной рейтинг
| Адрес                                       | Описание                                   |
|---------------------------------------------|--------------------------------------------|
| `GET /mpa`                                  | Получить список всех доступных `рейтингов` |
| `GET /mpa/{id}`                             | Получить конкретный `рейтинг` по ID        |


## Сборка и запуск
1. Установленная `IntelliJ IDEA`.
2. С помощью Maven собрать проект `mvn clean install`
3. Запустить исполняемый файл FilmorateApp.java
